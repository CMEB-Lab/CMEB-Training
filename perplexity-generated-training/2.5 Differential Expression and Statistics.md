<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" class="logo" width="120"/>

# Differential Expression & Statistical Analysis Training Manual (Module 2.5)

A 18-hour, competency-based program to master RNA-seq differential expression analysis and the underlying statistical concepts essential for robust biological inference and technical interviews.

## Learning Objectives

By module completion, learners will be able to:

1. Construct end-to-end differential expression workflows using DESeq2, edgeR, and limma-voom.
2. Understand and apply the statistical models behind negative-binomial and linear modeling approaches.
3. Perform multiple testing correction and interpret false discovery rates.
4. Visualize and interpret MA plots, volcano plots, heatmaps, and PCA for quality assessment and result presentation.

## Week 1 (Days 1–3): Statistical Foundations & DESeq2

### Day 1: Statistical Concepts & Negative-Binomial Modeling (6 hours)

1. **Theory Primer**
    - Count data distribution: Poisson vs. negative-binomial, mean-variance relationship
    - Overdispersion and its modeling with gene-specific dispersion estimates
    - Generalized linear models (GLMs) for differential expression
2. **R Exercise: Simulate Count Data**
```r
set.seed(42)
n_genes <- 1000; n_samples <- 6
# Two conditions: control (3) vs. treatment (3)
conds <- factor(rep(c(“ctrl”,”treat”), each=3))
counts <- matrix(rnbinom(n_genes*n_samples, mu=100, size=1/0.2),
                 nrow=n_genes, dimnames=list(paste0(“g”,1:n_genes), NULL))
# Introduce 100 DE genes with 2-fold change
de_idx <- sample(1:n_genes, 100)
counts[de_idx, 4:6] <- rnbinom(300, mu=200, size=1/0.2)
```

3. **Hands-On Quiz**
    - Compute mean and variance per gene; plot mean vs. variance and overlay NB fit.

### Day 2: DESeq2 Workflow (6 hours)

1. **Setup & Data Import**
```r
library(DESeq2)
coldata <- data.frame(condition=conds, row.names=colnames(counts))
dds <- DESeqDataSetFromMatrix(countData=counts, colData=coldata, design=~condition)
```

2. **Pre-Filtering & Normalization**
    - Filter out low-count genes: `keep <- rowSums(counts(dds)) >= 10`
    - Estimate size factors: median ratio method for library-size normalization
3. **Dispersion Estimation & Model Fitting**
```r
dds <- estimateSizeFactors(dds)
dds <- estimateDispersions(dds)
plotDispEsts(dds)  # Visualize dispersion estimates
dds <- nbinomWaldTest(dds)
```

4. **Result Extraction & Multiple Testing**
```r
res <- results(dds, alpha=0.05, lfcThreshold=1)
res <- lfcShrink(dds, coef=“condition_treat_vs_ctrl”, type=“apeglm”)
summary(res)  # Counts of up/down regulated genes
```

5. **Hands-On Exercise**
    - Identify top 20 DE genes; export to CSV with gene IDs, log₂FC, p-value, padj.

### Day 3: Visualization & Interpretation (6 hours)

1. **MA Plot & Volcano Plot**
```r
plotMA(res, ylim=c(-5,5))
library(EnhancedVolcano)
EnhancedVolcano(res,
                lab=rownames(res),
                x=“log2FoldChange”, y=“padj”,
                pCutoff=0.05, FCcutoff=1)
```

2. **Principal Component Analysis**
```r
rld <- rlog(dds);  # Regularized log transformation
plotPCA(rld, intgroup=“condition”)
```

3. **Heatmap of Top DE Genes**
```r
library(pheatmap)
topgenes <- head(order(res$padj),20)
mat <- assay(rld)[topgenes, ]
pheatmap(mat, annotation_col=coldata)
```

4. **Hands-On Practice**
    - Generate and interpret each plot for your simulated dataset; annotate key observations.

## Week 2 (Days 4–6): edgeR, limma-voom & Advanced Techniques

### Day 4: edgeR Workflow (6 hours)

1. **Data Import & DGEList**
```r
library(edgeR)
group <- conds
y <- DGEList(counts=counts, group=group)
```

2. **Filtering & Normalization**
```r
keep <- filterByExpr(y)
y <- y[keep, , keep.lib.sizes=FALSE]
y <- calcNormFactors(y)  # TMM method
```

3. **Dispersion & Model Fitting**
```r
y <- estimateDisp(y, design=model.matrix(~group))
fit <- glmQLFit(y, design)
qlf <- glmQLFTest(fit, coef=2)
topTags(qlf)
```

4. **Hands-On Exercise**
    - Compare DE gene lists from edgeR vs. DESeq2; compute overlap and unique calls.

### Day 5: limma-voom Pipeline (6 hours)

1. **voom Transformation**
```r
library(limma)
v <- voom(y, design=model.matrix(~group), plot=TRUE)
fit2 <- lmFit(v, design)
fit2 <- eBayes(fit2)
topTable(fit2, coef=2)
```

2. **Mean-Variance Trend**
    - Plot voom mean-variance trend; interpret residual variance.
3. **Hands-On Comparison**
    - Contrast log₂FC and p-value distributions across DESeq2, edgeR, voom; discuss strengths.

### Day 6: Multiple Testing & Reporting (6 hours)

1. **False Discovery Rate Control**
    - BH (Benjamini–Hochberg) vs. Bonferroni; practical implications for sensitivity vs. specificity.
2. **Gene Set Enrichment Analysis (GSEA)**
    - Prepare ranked gene list: `rank <- res$stat` or `log2FC`; run `fgsea` or `clusterProfiler`.
```r
library(clusterProfiler)
ego <- enrichGO(gene=names(rank), OrgDb=org.Hs.eg.db,
                keyType=“ENSEMBL”, ont=“BP”,
                pAdjustMethod=“BH”, pvalueCutoff=0.05)
dotplot(ego)
```

3. **Automated Reporting**
    - Knit RMarkdown combining code, results, and plots into a reproducible HTML report.
```r
rmarkdown::render(“de_analysis_report.Rmd”)
```

4. **Capstone Exercise**
    - Apply complete DESeq2 & voom pipelines to a public RNA-seq dataset (e.g., GEO series with 4+ samples per group).
    - Produce a written summary of biological findings, including tables of top pathways and visualizations.

## Assessment Framework

| Competency Area | Beginner (0–60%) | Intermediate (61–80%) | Advanced (81–100%) |
| :-- | :-- | :-- | :-- |
| **Statistical Understanding** | Understand NB vs. Poisson; basic GLM concepts | Explain dispersion estimation; interpret model diagnostics | Critique model assumptions; propose alternative statistical strategies |
| **DESeq2 Implementation** | Run core DESeq2 pipeline | Use shrinkage, custom contrasts, lfc thresholds | Optimize parameters, integrate with external metadata, custom modeling |
| **edgeR & limma-voom** | Execute edgeR and voom pipelines | Compare methods, tune normalization | Combine methods, adjust for batch effects, integrate covariates |
| **Visualization & Interpretation** | Generate MA/volcano/PCA plots | Annotate, customize plots for publication | Develop interactive dashboards, multi-omic integration |
| **Reporting & Reproducibility** | Knit basic RMarkdown report | Include parameter descriptions, session info | Automate workflows, integrate CI/CD, containerized reproducible analysis |

### Key References

- Love, Huber & Anders, *Genome Biology* 2014 (DESeq2)
- Robinson, McCarthy & Smyth, *Bioinformatics* 2010 (edgeR)
- Law et al., *Genome Biology* 2014 (limma-voom)
- Benjamini & Hochberg, *JRSS B* 1995 (FDR control)
- Sergushichev, *FGSEA* package for fast GSEA

Upon completion, learners will confidently design, execute, and interpret differential expression analyses—demonstrating the full breadth of statistical and bioinformatics expertise expected in technical interviews and research environments.

